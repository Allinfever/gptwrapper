# ğŸ—ï¸ Architecture Visuelle - Correcteur

## ğŸ“Š Vue d'Ensemble du SystÃ¨me

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         UTILISATEUR                              â”‚
â”‚                    (Navigateur Web)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP/HTTPS
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FRONTEND (Next.js 16)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Landing Page (/)                                        â”‚   â”‚
â”‚  â”‚  - Hero section                                          â”‚   â”‚
â”‚  â”‚  - BÃ©nÃ©fices                                             â”‚   â”‚
â”‚  â”‚  - CTA â†’ /app                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Application (/app)                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ ModeSelector                                       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ [Typo] [Standard*] [Strict]                       â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ TextArea (Input)                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ "Collez votre texte..."                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ [12,000 caractÃ¨res max]                            â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ [Corriger mon texte]                               â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ StatsDisplay                                       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ âœ… 8 corrections | â±ï¸ 1.2s                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ 3 accords â€¢ 2 conjugaisons â€¢ 2 orthographe        â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ DiffViewer                                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ - Texte avec surlignage colorÃ©                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ - Liste dÃ©taillÃ©e des corrections                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ - Boutons Accepter/Refuser                         â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ Texte Final                                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ [Copier]                                           â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ API Call (POST /api/correct)
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND (Next.js API Routes)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /api/correct                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 1. Validation du texte                             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Longueur < 12,000 caractÃ¨res                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Contenu non vide                              â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 2. Authentification (Supabase)                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Check si utilisateur connectÃ©                 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - RÃ©cupÃ©ration du quota                         â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 3. Rate Limiting                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Anonyme: 10/jour (IP-based)                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - ConnectÃ©: 50/jour (DB-based)                  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 4. SÃ©lection du Prompt (selon mode)                â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Typo: Prompt minimaliste                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Standard: Prompt complet                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Strict: Prompt + typographie                  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 5. Appel OpenAI                                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Model: gpt-4o-mini                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Temperature: 0.3                              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Response format: JSON                         â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 6. Parsing de la RÃ©ponse                           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - corrected_text                                â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - changes[] (positions, types, explications)    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - rules_applied[]                               â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 7. Calcul des Statistiques                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - total_changes                                 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - by_category                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - processing_time_ms                            â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 8. Enregistrement (si connectÃ©)                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - IncrÃ©mentation du compteur                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - Sauvegarde dans corrections table             â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 9. Retour de la RÃ©ponse                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    - CorrectionResponse (JSON)                     â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                  â”‚
        â”‚                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   OpenAI API   â”‚              â”‚     Supabase       â”‚
â”‚                â”‚              â”‚                    â”‚
â”‚ - gpt-4o-mini  â”‚              â”‚ - Auth             â”‚
â”‚ - Correction   â”‚              â”‚ - Users table      â”‚
â”‚ - JSON format  â”‚              â”‚ - Corrections      â”‚
â”‚                â”‚              â”‚ - Quotas           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flux de DonnÃ©es DÃ©taillÃ©

### 1. RequÃªte Utilisateur

```
Utilisateur
    â”‚
    â”‚ 1. Saisit du texte
    â”‚ 2. SÃ©lectionne un mode
    â”‚ 3. Clique "Corriger"
    â”‚
    â–¼
Frontend (React State)
    â”‚
    â”‚ inputText: string
    â”‚ mode: CorrectionMode
    â”‚
    â–¼
API Call (fetch)
    â”‚
    â”‚ POST /api/correct
    â”‚ Body: { text, mode }
    â”‚
    â–¼
Backend
```

### 2. Traitement Backend

```
Backend (/api/correct)
    â”‚
    â”œâ”€â–º Validation
    â”‚   â”œâ”€ Longueur OK ?
    â”‚   â””â”€ Contenu OK ?
    â”‚
    â”œâ”€â–º Authentification
    â”‚   â”œâ”€ Supabase.auth.getUser()
    â”‚   â””â”€ user | null
    â”‚
    â”œâ”€â–º Rate Limiting
    â”‚   â”œâ”€ Si user: Check DB quota
    â”‚   â””â”€ Si anonyme: Check IP quota
    â”‚
    â”œâ”€â–º SÃ©lection du Prompt
    â”‚   â”œâ”€ getModeConfig(mode)
    â”‚   â””â”€ prompt: string
    â”‚
    â”œâ”€â–º Appel OpenAI
    â”‚   â”œâ”€ openai.chat.completions.create()
    â”‚   â””â”€ response: JSON
    â”‚
    â”œâ”€â–º Parsing
    â”‚   â”œâ”€ JSON.parse(response)
    â”‚   â””â”€ { corrected_text, changes, rules_applied }
    â”‚
    â”œâ”€â–º Statistiques
    â”‚   â”œâ”€ Calcul du temps
    â”‚   â”œâ”€ Comptage par catÃ©gorie
    â”‚   â””â”€ stats: CorrectionStats
    â”‚
    â”œâ”€â–º Enregistrement
    â”‚   â”œâ”€ Si user: Supabase.insert()
    â”‚   â””â”€ Si anonyme: rateLimiter.recordUsage()
    â”‚
    â””â”€â–º RÃ©ponse
        â””â”€ CorrectionResponse (JSON)
```

### 3. Affichage Frontend

```
Frontend (RÃ©ception)
    â”‚
    â”‚ correctionData: CorrectionResponse
    â”‚
    â”œâ”€â–º StatsDisplay
    â”‚   â”œâ”€ stats.total_changes
    â”‚   â”œâ”€ stats.by_category
    â”‚   â””â”€ stats.processing_time_ms
    â”‚
    â”œâ”€â–º DiffViewer
    â”‚   â”œâ”€ changes[] â†’ Surlignage
    â”‚   â”œâ”€ Tooltips au survol
    â”‚   â””â”€ Liste dÃ©taillÃ©e
    â”‚
    â”œâ”€â–º Acceptation/Refus
    â”‚   â”œâ”€ acceptedChanges: Set<string>
    â”‚   â””â”€ Mise Ã  jour en temps rÃ©el
    â”‚
    â””â”€â–º Texte Final
        â”œâ”€ applyChanges(original, changes, accepted)
        â””â”€ finalText: string
```

---

## ğŸ—‚ï¸ Structure des Composants React

```
App (/app/page.tsx)
â”‚
â”œâ”€â–º Header
â”‚   â”œâ”€ Logo
â”‚   â”œâ”€ Quota Display
â”‚   â””â”€ UserMenu
â”‚
â”œâ”€â–º Main Content
â”‚   â”‚
â”‚   â”œâ”€â–º Input Section
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º ModeSelector
â”‚   â”‚   â”‚   â”œâ”€ Typo Card
â”‚   â”‚   â”‚   â”œâ”€ Standard Card (selected)
â”‚   â”‚   â”‚   â””â”€ Strict Card
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â–º TextArea
â”‚   â”‚   â”‚   â”œâ”€ Input field
â”‚   â”‚   â”‚   â”œâ”€ Character counter
â”‚   â”‚   â”‚   â””â”€ Progress bar
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â–º Submit Button
â”‚   â”‚       â””â”€ "Corriger mon texte"
â”‚   â”‚
â”‚   â””â”€â–º Output Section
â”‚       â”‚
â”‚       â”œâ”€â–º StatsDisplay
â”‚       â”‚   â”œâ”€ Total corrections
â”‚       â”‚   â”œâ”€ Processing time
â”‚       â”‚   â””â”€ Category breakdown
â”‚       â”‚
â”‚       â”œâ”€â–º DiffViewer
â”‚       â”‚   â”œâ”€ Header (count + "Tout accepter")
â”‚       â”‚   â”œâ”€ Highlighted Text
â”‚       â”‚   â””â”€ Detailed List
â”‚       â”‚       â”œâ”€ Change Card 1
â”‚       â”‚       â”œâ”€ Change Card 2
â”‚       â”‚       â””â”€ Change Card N
â”‚       â”‚
â”‚       â””â”€â–º Final Text
â”‚           â”œâ”€ Text display
â”‚           â””â”€ Copy button
â”‚
â””â”€â–º Footer
    â”œâ”€ Copyright
    â””â”€ Legal links
```

---

## ğŸ¨ SystÃ¨me de Couleurs

```
Modes:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mode            â”‚ Couleur  â”‚ Badge      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Typo uniquement â”‚ Vert     â”‚ Rapide     â”‚
â”‚ Standard        â”‚ Bleu     â”‚ RecommandÃ© â”‚
â”‚ Strict          â”‚ Violet   â”‚ Pro        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CatÃ©gories de Correction:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CatÃ©gorie    â”‚ Couleur  â”‚ Classe Tailwind â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Orthographe  â”‚ ğŸ”´ Rouge â”‚ red-100/700     â”‚
â”‚ Grammaire    â”‚ ğŸ”µ Bleu  â”‚ blue-100/700    â”‚
â”‚ Conjugaison  â”‚ ğŸŸ£ Violetâ”‚ purple-100/700  â”‚
â”‚ Ponctuation  â”‚ ğŸŸ¢ Vert  â”‚ green-100/700   â”‚
â”‚ Accord       â”‚ ğŸŸ  Orangeâ”‚ orange-100/700  â”‚
â”‚ Typographie  â”‚ ğŸ©· Rose  â”‚ pink-100/700    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Modules et DÃ©pendances

```
gptwrapper
â”‚
â”œâ”€â–º Frontend
â”‚   â”œâ”€ Next.js 16 (Framework)
â”‚   â”œâ”€ React 19 (UI Library)
â”‚   â”œâ”€ TypeScript (Language)
â”‚   â”œâ”€ Tailwind CSS v4 (Styling)
â”‚   â””â”€ Lucide React (Icons)
â”‚
â”œâ”€â–º Backend
â”‚   â”œâ”€ Next.js API Routes (Server)
â”‚   â”œâ”€ OpenAI SDK (AI)
â”‚   â””â”€ Supabase Client (Auth/DB)
â”‚
â””â”€â–º Utilitaires
    â”œâ”€ lib/types/correction.ts (Types)
    â”œâ”€ lib/correction/modes.ts (Config)
    â”œâ”€ lib/diff/textDiffer.ts (Algorithmes)
    â””â”€ lib/rateLimiter.ts (Rate limiting)
```

---

## ğŸ” SÃ©curitÃ© et ConfidentialitÃ©

```
DonnÃ©es Utilisateur
â”‚
â”œâ”€â–º Anonyme
â”‚   â”œâ”€ Texte envoyÃ© Ã  OpenAI
â”‚   â”œâ”€ Pas de stockage
â”‚   â””â”€ Rate limiting IP-based
â”‚
â””â”€â–º ConnectÃ©
    â”œâ”€ Texte envoyÃ© Ã  OpenAI
    â”œâ”€ Stockage dans Supabase
    â”‚   â”œâ”€ corrections table
    â”‚   â””â”€ correction_counts table
    â””â”€ Rate limiting DB-based

Variables Sensibles
â”‚
â”œâ”€ OPENAI_API_KEY (serveur uniquement)
â”œâ”€ SUPABASE_URL (public)
â”œâ”€ SUPABASE_ANON_KEY (public)
â””â”€ .env.local (non commitÃ©)
```

---

## ğŸ“Š Performance

```
Temps de RÃ©ponse Cible
â”‚
â”œâ”€â–º Frontend
â”‚   â”œâ”€ Rendu initial: < 1s
â”‚   â”œâ”€ Interaction: < 100ms
â”‚   â””â”€ Mise Ã  jour state: < 50ms
â”‚
â””â”€â–º Backend
    â”œâ”€ Validation: < 10ms
    â”œâ”€ Auth check: < 50ms
    â”œâ”€ OpenAI call: 1-3s
    â”œâ”€ Parsing: < 10ms
    â””â”€ DB write: < 100ms

Total: 1-4 secondes (bout en bout)
```

---

**Cette architecture est conÃ§ue pour Ãªtre :**
- âœ… **Modulaire** : Composants rÃ©utilisables
- âœ… **Scalable** : PrÃªte pour la croissance
- âœ… **Maintenable** : Code clair et documentÃ©
- âœ… **Performante** : Optimisations en place
- âœ… **SÃ©curisÃ©e** : DonnÃ©es protÃ©gÃ©es
